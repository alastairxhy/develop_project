<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<title>首页</title>
		<link rel="stylesheet" type="text/css" href="websource/js/layui/css/layui.css" />
		<link rel="stylesheet" type="text/css" href="websource/css/style.css" />
	    <style type="text/css">
            html {
                height: 100%
            }
            body {
                height: 100%;margin: 0px;padding: 0px
            }
            #baiduMap {width: 100%;height: 100%;overflow: hidden;margin:0;}
			.top_left_window1{
				z-index: 100;
			}
			.top_left_window2{
				z-index: 100;
			}
            .top_right_window{
                z-index: 100;
            }
            .layui-form-label{
                width: 60px !important;
            }
        </style>
    </head>
	<body>
		<div id="user_info">
			<!--信息容器-->
			<div class="top_left_window1">
				<!--左上第一容器-->
				<div class="top_left_window1_title">电梯密度分布图</div>
				<div class="layui-form-item">
					<label class="layui-form-label">物联电梯:</label>
					<div class="layui-input-block " ></div>
				</div>
			</div>
                <div class="top_left_window2"  >
				<!--左上第二容器-->
			</div>
			<div class="top_right_window">
				<!--右上第一容器-->
				<div class="top_right_window_title">入网统计</div>
				<div class="layui-form-item">
					<label class="layui-form-label">物联电梯:</label>
					<div class="layui-input-block " ></div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">在线电梯:</label>
					<div class="layui-input-block " ></div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">离线电梯:</label>
					<div class="layui-input-block " ></div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">维保单位:</label>
					<div class="layui-input-block " ></div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">使用单位:</label>
					<div class="layui-input-block " ></div>
				</div>

			</div>
		</div>
        <div id="baiduMap">
            <!--地图容器-->

        </div>



		<script src="websource/js/jquery-3.3.1.js" type="text/javascript" charset="utf-8"></script>
		<script src="websource/js/vue.js" type="text/javascript" charset="utf-8"></script>
		<script src="websource/js/layui/layui.all.js" type="text/javascript" charset="utf-8"></script>
        <script src="http://api.map.baidu.com/api?v=2.0&ak=3b55d902d2eb9763e7a76a40a2bfa0bf" type="text/javascript" ></script>
        <script src="websource/js/public.js" type="text/javascript" charset="utf-8"></script>
		<script src="websource/js/echarts.js" type="text/javascript" charset="utf-8"></script>
		<!--实现聚合点API-->
		<script type="text/javascript" src="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"></script>
		<script type="text/javascript" src="http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js"></script>
		<!---->

		<script type="text/javascript" charset="utf-8">
			layui.use(["layer", "element", "form"], function() {
				var layer = layui.layer,
					element = layui.element,
					form = layui.form;

                //地图说明
                var map = new BMap.Map("baiduMap", {enableMapClick: false}); //实例化地图
                map.enableScrollWheelZoom(true);//开启鼠标滚轮缩

                $.ajax({
                    data:{
                        "methodName": "serviceData",
                        "distance":"10000"
                    },
                    success:function (res) {
                        var obj=res.obj;
                        console.log(obj);
                        //定位初始点
                        var long = res.obj.userInfo.longitude,
                            lati = res.obj.userInfo.latitude; // 经纬度变量

                        var initiationpoint = new BMap.Point(long, lati);//设置中心点
                        map.centerAndZoom(initiationpoint, 18);		   //初始化地图,设置中心点坐标和地图级别

						function addMarker(point){
						//创建标注点
                            var marker = new BMap.Marker(point);// 创建标注
                            map.addOverlay(marker);				// 将标注添加到地图中
                        }
						//电梯分布
                        var markers = []; //聚合点数组
						for (i = 0; i < obj.list.length; i++) {
                            var point = new BMap.Point(obj.list[i].longitude, obj.list[i].latitude);
                            addMarker(point);
                            markers.push(new BMap.Marker(point));
                            map.clearOverlays();
                        }
						//电梯分布点聚合
                        //最简单的用法，生成一个marker数组，然后调用markerClusterer类即可。
						function markerClusterer() {
                            addMarker(initiationpoint);
                            var markerClusterer = new BMapLib.MarkerClusterer(map, {markers:markers});

                        }
                        markerClusterer();



                    }
                })



			})

		</script>

	</body>

</html>